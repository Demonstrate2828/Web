# Klik Call Server

WebSocket сервер для звонков в мессенджере Клик.

## Деплой на Railway

1. Создайте новый проект на [Railway](https://railway.app)
2. Подключите этот репозиторий или загрузите файлы
3. Railway автоматически обнаружит Node.js и запустит `npm start`
4. Скопируйте URL вашего сервера (например: `klik-call-server.up.railway.app`)
5. Вставьте этот URL в настройки мессенджера

## Локальный запуск

```bash
npm install
npm start
```

Сервер запустится на порту 3000 (или PORT из переменных окружения).

## API

- `GET /health` - проверка статуса сервера
- WebSocket на `/` - подключение для звонков

## Сообщения WebSocket

### От клиента:
- `register` - регистрация пользователя
- `call-request` - запрос на звонок
- `call-accept` - принять звонок
- `call-decline` - отклонить звонок
- `call-end` - завершить звонок
- `media-chunk` - аудио/видео данные

### От сервера:
- `registered` - подтверждение регистрации
- `call-request` - входящий звонок
- `call-accepted` - звонок принят
- `call-declined` - звонок отклонён
- `call-ended` - звонок завершён
- `user-offline` - пользователь не в сети
- `media-chunk` - входящие аудио/видео данные
